# FlowState Configuration
# Copy this file to config.yaml and customize for your deployment

station:
  # Unique ID for this device (station1, station2, etc.)
  device_id: "station1"

  # Which stage this station logs
  # Options: QUEUE_JOIN, EXIT (or custom stages for future)
  stage: "QUEUE_JOIN"

  # Session ID for this deployment (e.g., festival name + date)
  # All events logged during this session will have this ID
  session_id: "my-event-2026"

database:
  # Path to SQLite database
  path: "data/events.db"

  # Enable WAL mode for crash resistance
  wal_mode: true

nfc:
  # I2C bus (usually 1 for Pi Zero 2)
  i2c_bus: 1

  # I2C address for PN532
  address: 0x24

  # Read timeout (seconds)
  timeout: 2

  # Retry attempts on failed read
  retries: 3

  # Debounce time (seconds) - ignore same card within this window
  debounce_seconds: 1.0

  # Auto-initialize cards on first tap (assigns next available token ID)
  # When enabled, fresh cards can be used without pre-initialization
  # The system will automatically assign the next sequential token ID
  auto_init_cards: false

  # Starting token ID for auto-initialization (default: 1)
  auto_init_start_id: 1

feedback:
  # Enable/disable feedback mechanisms
  buzzer_enabled: true
  led_enabled: true

  # GPIO pin assignments (BCM numbering)
  gpio:
    buzzer: 17
    led_green: 27
    led_red: 22

  # Beep patterns (on/off times in seconds)
  # Format: [on, off, on, off, ...]
  # These can be customized for different audio signatures
  beep_success: [0.1]                # Short single beep
  beep_duplicate: [0.1, 0.05, 0.1]   # Quick double beep
  beep_error: [0.3]                  # Long beep
  
  # LED Behavior:
  # - Solid green = Ready/idle state
  # - Flashing green (3x) = Success
  # - Flashing yellow (2x) = Duplicate/Warning
  # - Flashing red (3x) = Error
  # Events automatically return to solid green after feedback

shutdown_button:
  # Enable shutdown button (GPIO 26)
  enabled: true
  
  # GPIO pin for shutdown button (BCM numbering)
  gpio_pin: 26
  
  # Hold time in seconds to trigger shutdown
  hold_time: 3.0
  
  # Shutdown delay in minutes (0 for immediate shutdown)
  delay_minutes: 1

logging:
  # Log file path
  path: "logs/tap-station.log"

  # Log level (DEBUG, INFO, WARNING, ERROR)
  level: "INFO"

  # Max log file size (MB)
  max_size_mb: 10

  # Number of backup log files
  backup_count: 3

web_server:
  # Enable built-in status/health server
  enabled: true

  # Bind host and port
  host: "0.0.0.0"
  port: 8080

  # Admin authentication for control panel
  # Set a password to protect administrative functions
  # All staff members can use this password during shift
  admin:
    # Password for accessing control panel
    # IMPORTANT: Change this before deployment!
    # Use a strong password (min 12 characters, mix of letters/numbers/symbols)
    password: "CHANGE-ME-BEFORE-DEPLOYMENT"
    
    # Session timeout in minutes (auto-logout after inactivity)
    session_timeout_minutes: 60

# Extensions - modular features that can be enabled/disabled
# Each extension adds specific functionality. Enable only what you need.
extensions:
  enabled:
    - notes                # Operational notes for staff during shifts
    - export               # CSV/JSON data export
    - shift_summary        # Shift handoff reports
    - event_summary        # End-of-day summary with goals
    - insights             # Service quality SLI/SLO metrics
    - anomalies            # Real-time anomaly detection
    - stuck_cards          # Detect and force-exit stuck cards
    - manual_corrections   # Manual event add/remove for corrections
    - hardware_monitor     # Raspberry Pi hardware status
    - three_stage          # Queue wait vs service time breakdown
    - smart_estimates      # Intelligent wait time predictions
    - substance_tracking   # Substance return rate tracking
